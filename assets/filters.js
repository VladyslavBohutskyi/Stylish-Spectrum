"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _wrapNativeSuper(e){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function _construct(e,t,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);t=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(t,r.prototype),t}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}!function n(o,i,c){function u(t,e){if(!i[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(s)return s(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=i[t]={exports:{}},o[t][0].call(r.exports,function(e){return u(o[t][1][e]||e)},r,r.exports,n,o,i,c)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<c.length;e++)u(c[e]);return u}({1:[function(e,t,r){customElements.get("main-filters")||customElements.define("main-filters",function(){_inherits(r,_wrapNativeSuper(HTMLElement));var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),_defineProperty(_assertThisInitialized(e=t.call(this)),"searchParams",new URLSearchParams(window.location.search)),e}return _createClass(r,[{key:"connectedCallback",value:function(){this.addListeners()}},{key:"addListeners",value:function(){var r=this;this.querySelector("#sort-by").addEventListener("change",function(){return r.sortBy()}),this.querySelectorAll(".main-filters__filters__item").forEach(function(e){return e.addEventListener("click",function(){return r.openFilter(e)})}),document.addEventListener("click",function(e){e.target.closest(".main-filters__filters__item")||e.target.closest(".main-filters__filters__item__dropdown")||r.querySelectorAll(".main-filters__filters__item").forEach(function(e){return e.classList.remove("active")})}),this.querySelectorAll(".main-filters__filters__item__list__add_filter").forEach(function(t){return t.addEventListener("click",function(e){return r.updatePage(t,e)})})}},{key:"sortBy",value:function(){this.searchParams.set("sort_by",this.querySelector("#sort-by").value),window.location.search=this.searchParams.toString()}},{key:"openFilter",value:function(e){this.querySelectorAll(".main-filters__filters__item").forEach(function(e){return e.classList.remove("active")}),e.classList.add("active")}},{key:"updatePage",value:function(e,t){var n=this,o=(t.preventDefault(),e.dataset.filterValue);fetch(window.theme.shopUrl+o).then(function(e){return e.text()}).then(function(e){history.replaceState(null,null,window.theme.shopUrl+o),n.searchParams=new URLSearchParams(window.location.search);var r=(new DOMParser).parseFromString(e,"text/html");document.querySelector(".main-collection__products").innerHTML=r.querySelector(".main-collection__products").innerHTML,n.querySelectorAll(".main-filters__filters__item__list").forEach(function(e,t){e.innerHTML=r.querySelectorAll(".main-filters__filters__item__list")[t].innerHTML}),n.querySelector(".main-filters__checked").innerHTML=r.querySelector(".main-filters__checked").innerHTML,n.addListeners()})}}]),r}())},{}]},{},[1]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvZmlsdGVycy5qcyIsImZpbHRlcnMuanMiXSwibmFtZXMiOlsiciIsImUiLCJuIiwidCIsIm8iLCJpIiwiZiIsImMiLCJyZXF1aXJlIiwidSIsImEiLCJFcnJvciIsImNvZGUiLCJwIiwiZXhwb3J0cyIsImNhbGwiLCJsZW5ndGgiLCIxIiwibW9kdWxlIiwiY3VzdG9tRWxlbWVudHMiLCJnZXQiLCJkZWZpbmUiLCJfaW5oZXJpdHMiLCJNRmlsdGVycyIsIl93cmFwTmF0aXZlU3VwZXIiLCJIVE1MRWxlbWVudCIsIl9zdXBlciIsIl9jcmVhdGVTdXBlciIsIl90aGlzIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsIl9kZWZpbmVQcm9wZXJ0eSIsIl9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQiLCJVUkxTZWFyY2hQYXJhbXMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsIl9jcmVhdGVDbGFzcyIsImtleSIsInZhbHVlIiwiYWRkTGlzdGVuZXJzIiwiX3RoaXMyIiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJzb3J0QnkiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImVsIiwib3BlbkZpbHRlciIsImRvY3VtZW50IiwidGFyZ2V0IiwiY2xvc2VzdCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInVwZGF0ZVBhZ2UiLCJzZWFyY2hQYXJhbXMiLCJzZXQiLCJ0b1N0cmluZyIsImFkZCIsIl90aGlzMyIsImZpbHRlclZhbHVlIiwicHJldmVudERlZmF1bHQiLCJkYXRhc2V0IiwiZmV0Y2giLCJ0aGVtZSIsInNob3BVcmwiLCJ0aGVuIiwicmVzIiwidGV4dCIsImRhdGEiLCJoaXN0b3J5IiwicmVwbGFjZVN0YXRlIiwiaHRtbCIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsImlubmVySFRNTCIsImluZGV4Il0sIm1hcHBpbmdzIjoiNmdIQUFBLENBQUEsU0FBQUEsRUFBQUMsRUFBQUMsRUFBQUMsR0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUFBLEdBQUEsQ0FBQUosRUFBQUcsR0FBQSxDQUFBLEdBQUEsQ0FBQUosRUFBQUksR0FBQSxDQUFBLElBQUFFLEVBQUEsWUFBQSxPQUFBQyxTQUFBQSxRQUFBLEdBQUEsQ0FBQUYsR0FBQUMsRUFBQSxPQUFBQSxFQUFBRixFQUFBLENBQUEsQ0FBQSxFQUFBLEdBQUFJLEVBQUEsT0FBQUEsRUFBQUosRUFBQSxDQUFBLENBQUEsRUFBQSxNQUFBSyxFQUFBLElBQUFDLE1BQUEsdUJBQUFOLEVBQUEsR0FBQSxHQUFBTyxLQUFBLG1CQUFBRixDQUFBLENBQUFHLEVBQUFYLEVBQUFHLEdBQUEsQ0FBQVMsUUFBQSxFQUFBLEVBQUFiLEVBQUFJLEdBQUEsR0FBQVUsS0FBQUYsRUFBQUMsUUFBQSxTQUFBZCxHQUFBLE9BQUFJLEVBQUFILEVBQUFJLEdBQUEsR0FBQUwsSUFBQUEsQ0FBQSxDQUFBLEVBQUFhLEVBQUFBLEVBQUFDLFFBQUFkLEVBQUFDLEVBQUFDLEVBQUFDLENBQUEsQ0FBQSxDQUFBLE9BQUFELEVBQUFHLEdBQUFTLE9BQUEsQ0FBQSxJQUFBLElBQUFMLEVBQUEsWUFBQSxPQUFBRCxTQUFBQSxRQUFBSCxFQUFBLEVBQUFBLEVBQUFGLEVBQUFhLE9BQUFYLENBQUEsR0FBQUQsRUFBQUQsRUFBQUUsRUFBQSxFQUFBLE9BQUFELENBQUEsRUFBQSxDQUFBYSxFQUFBLENBQUEsU0FBQVQsRUFBQVUsRUFBQUosR0NBQUssZUFBQUMsSUFBQSxjQUFBLEdBQ0FELGVBQUFFLE9BQUEsZUFBQSxXQUFBQyxVQUFBQyxFQStDQUMsaUJBL0NBQyxXQUFBLENBQUEsRUFBQSxJQUFBQyxFQUFBQyxhQUFBSixDQUFBLEVBQ0EsU0FBQUEsSUFBQSxJQUFBSyxFQUlBLE9BSkFDLGdCQUFBQyxLQUFBUCxDQUFBLEVBQ0FRLGdCQUFBQyx1QkFBQUosRUFBQUYsRUFBQVgsS0FBQWUsSUFBQSxDQUFBLEVBQUEsZUFHQSxJQUFBRyxnQkFBQUMsT0FBQUMsU0FBQUMsTUFBQSxDQUFBLEVBQUFSLENBRkEsQ0E0Q0EsT0E1Q0FTLGFBQUFkLEVBQUEsQ0FBQSxDQUFBZSxJQUFBLG9CQUFBQyxNQUdBLFdBQ0FULEtBQUFVLGFBQUEsQ0FDQSxDQUFBLEVBQUEsQ0FBQUYsSUFBQSxlQUFBQyxNQUVBLFdBQUEsSUFBQUUsRUFBQVgsS0FDQUEsS0FBQVksY0FBQSxVQUFBLEVBQUFDLGlCQUFBLFNBQUEsV0FBQSxPQUFBRixFQUFBRyxPQUFBLENBQUEsQ0FBQSxFQUNBZCxLQUFBZSxpQkFBQSw4QkFBQSxFQUFBQyxRQUFBLFNBQUFDLEdBQUEsT0FBQUEsRUFBQUosaUJBQUEsUUFBQSxXQUFBLE9BQUFGLEVBQUFPLFdBQUFELENBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxFQUNBRSxTQUFBTixpQkFBQSxRQUFBLFNBQUExQyxHQUNBQSxFQUFBaUQsT0FBQUMsUUFBQSw4QkFBQSxHQUFBbEQsRUFBQWlELE9BQUFDLFFBQUEsd0NBQUEsR0FDQVYsRUFBQUksaUJBQUEsOEJBQUEsRUFBQUMsUUFBQSxTQUFBQyxHQUFBLE9BQUFBLEVBQUFLLFVBQUFDLE9BQUEsUUFBQSxDQUFBLENBQUEsQ0FFQSxDQUFBLEVBQ0F2QixLQUFBZSxpQkFBQSxnREFBQSxFQUFBQyxRQUFBLFNBQUFDLEdBQUEsT0FBQUEsRUFBQUosaUJBQUEsUUFBQSxTQUFBMUMsR0FBQSxPQUFBd0MsRUFBQWEsV0FBQVAsRUFBQTlDLENBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxDQUNBLENBQUEsRUFBQSxDQUFBcUMsSUFBQSxTQUFBQyxNQUVBLFdBQ0FULEtBQUF5QixhQUFBQyxJQUFBLFVBQUExQixLQUFBWSxjQUFBLFVBQUEsRUFBQUgsS0FBQSxFQUNBTCxPQUFBQyxTQUFBQyxPQUFBTixLQUFBeUIsYUFBQUUsU0FBQSxDQUNBLENBQUEsRUFBQSxDQUFBbkIsSUFBQSxhQUFBQyxNQUVBLFNBQUFRLEdBQ0FqQixLQUFBZSxpQkFBQSw4QkFBQSxFQUFBQyxRQUFBLFNBQUFDLEdBQUEsT0FBQUEsRUFBQUssVUFBQUMsT0FBQSxRQUFBLENBQUEsQ0FBQSxFQUNBTixFQUFBSyxVQUFBTSxJQUFBLFFBQUEsQ0FDQSxDQUFBLEVBQUEsQ0FBQXBCLElBQUEsYUFBQUMsTUFFQSxTQUFBUSxFQUFBOUMsR0FBQSxJQUFBMEQsRUFBQTdCLEtBRUE4QixHQURBM0QsRUFBQTRELGVBQUEsRUFDQWQsRUFBQWUsUUFBQUYsYUFDQUcsTUFBQTdCLE9BQUE4QixNQUFBQyxRQUFBTCxDQUFBLEVBQ0FNLEtBQUEsU0FBQUMsR0FBQSxPQUFBQSxFQUFBQyxLQUFBLENBQUEsQ0FBQSxFQUNBRixLQUFBLFNBQUFHLEdBQ0FDLFFBQUFDLGFBQUEsS0FBQSxLQUFBckMsT0FBQThCLE1BQUFDLFFBQUFMLENBQUEsRUFDQUQsRUFBQUosYUFBQSxJQUFBdEIsZ0JBQUFDLE9BQUFDLFNBQUFDLE1BQUEsRUFDQSxJQUFBb0MsR0FBQSxJQUFBQyxXQUFBQyxnQkFBQUwsRUFBQSxXQUFBLEVBQ0FwQixTQUFBUCxjQUFBLDRCQUFBLEVBQUFpQyxVQUFBSCxFQUFBOUIsY0FBQSw0QkFBQSxFQUFBaUMsVUFDQWhCLEVBQUFkLGlCQUFBLG9DQUFBLEVBQUFDLFFBQUEsU0FBQUMsRUFBQTZCLEdBQ0E3QixFQUFBNEIsVUFBQUgsRUFBQTNCLGlCQUFBLG9DQUFBLEVBQUErQixHQUFBRCxTQUNBLENBQUEsRUFDQWhCLEVBQUFqQixjQUFBLHdCQUFBLEVBQUFpQyxVQUFBSCxFQUFBOUIsY0FBQSx3QkFBQSxFQUFBaUMsVUFDQWhCLEVBQUFuQixhQUFBLENBQ0EsQ0FBQSxDQUNBLENBQUEsRUFBQSxFQUFBakIsQ0FBQSxFQS9DQSxDQWlEQSxDQ0dBLEVBQUUsR0FBRyxFQUFFLEdEbERQSyxDQUFBQSxFQUFBQSIsImZpbGUiOiJmaWx0ZXJzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImlmICghY3VzdG9tRWxlbWVudHMuZ2V0KCdtYWluLWZpbHRlcnMnKSkge1xyXG4gICAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdtYWluLWZpbHRlcnMnLCBjbGFzcyBNRmlsdGVycyBleHRlbmRzIEhUTUxFbGVtZW50IHtcclxuICAgICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICBzZWFyY2hQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpXHJcbiAgICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgICAgIHRoaXMuYWRkTGlzdGVuZXJzKClcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICBhZGRMaXN0ZW5lcnMoKXtcclxuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJyNzb3J0LWJ5JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCk9PiB0aGlzLnNvcnRCeSgpKVxyXG4gICAgICAgIHRoaXMucXVlcnlTZWxlY3RvckFsbCgnLm1haW4tZmlsdGVyc19fZmlsdGVyc19faXRlbScpLmZvckVhY2goZWwgPT4gZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHRoaXMub3BlbkZpbHRlcihlbCkpKVxyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT4ge1xyXG4gICAgICAgICAgaWYoIWUudGFyZ2V0LmNsb3Nlc3QoJy5tYWluLWZpbHRlcnNfX2ZpbHRlcnNfX2l0ZW0nKSAmJiAhZS50YXJnZXQuY2xvc2VzdCgnLm1haW4tZmlsdGVyc19fZmlsdGVyc19faXRlbV9fZHJvcGRvd24nKSl7XHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvckFsbCgnLm1haW4tZmlsdGVyc19fZmlsdGVyc19faXRlbScpLmZvckVhY2goZWwgPT4gZWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tYWluLWZpbHRlcnNfX2ZpbHRlcnNfX2l0ZW1fX2xpc3RfX2FkZF9maWx0ZXInKS5mb3JFYWNoKGVsID0+IGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT4gdGhpcy51cGRhdGVQYWdlKGVsLCBlKSkpXHJcbiAgICAgIH1cclxuICBcclxuICAgICAgc29ydEJ5KCl7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hQYXJhbXMuc2V0KCdzb3J0X2J5JywgdGhpcy5xdWVyeVNlbGVjdG9yKCcjc29ydC1ieScpLnZhbHVlKVxyXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5zZWFyY2ggPSB0aGlzLnNlYXJjaFBhcmFtcy50b1N0cmluZygpXHJcbiAgICAgIH1cclxuICBcclxuICAgICAgb3BlbkZpbHRlcihlbCl7XHJcbiAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yQWxsKCcubWFpbi1maWx0ZXJzX19maWx0ZXJzX19pdGVtJykuZm9yRWFjaChlbCA9PiBlbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSlcclxuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIHVwZGF0ZVBhZ2UoZWwsZSl7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgY29uc3QgZmlsdGVyVmFsdWUgPSBlbC5kYXRhc2V0LmZpbHRlclZhbHVlXHJcbiAgICAgICAgZmV0Y2god2luZG93LnRoZW1lLnNob3BVcmwgKyBmaWx0ZXJWYWx1ZSlcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHJlcy50ZXh0KCkpXHJcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCBudWxsLCB3aW5kb3cudGhlbWUuc2hvcFVybCArIGZpbHRlclZhbHVlKVxyXG4gICAgICAgICAgICB0aGlzLnNlYXJjaFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaClcclxuICAgICAgICAgICAgY29uc3QgaHRtbCA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoZGF0YSwgXCJ0ZXh0L2h0bWxcIik7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYWluLWNvbGxlY3Rpb25fX3Byb2R1Y3RzJykuaW5uZXJIVE1MID0gaHRtbC5xdWVyeVNlbGVjdG9yKCcubWFpbi1jb2xsZWN0aW9uX19wcm9kdWN0cycpLmlubmVySFRNTFxyXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tYWluLWZpbHRlcnNfX2ZpbHRlcnNfX2l0ZW1fX2xpc3QnKS5mb3JFYWNoKChlbCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICBlbC5pbm5lckhUTUwgPSBodG1sLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tYWluLWZpbHRlcnNfX2ZpbHRlcnNfX2l0ZW1fX2xpc3QnKVtpbmRleF0uaW5uZXJIVE1MXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLm1haW4tZmlsdGVyc19fY2hlY2tlZCcpLmlubmVySFRNTCA9IGh0bWwucXVlcnlTZWxlY3RvcignLm1haW4tZmlsdGVyc19fY2hlY2tlZCcpLmlubmVySFRNTFxyXG4gICAgICAgICAgICB0aGlzLmFkZExpc3RlbmVycygpXHJcbiAgICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICB9KVxyXG4gIH0iLCIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbmlmICghY3VzdG9tRWxlbWVudHMuZ2V0KCdtYWluLWZpbHRlcnMnKSkge1xyXG4gICAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdtYWluLWZpbHRlcnMnLCBjbGFzcyBNRmlsdGVycyBleHRlbmRzIEhUTUxFbGVtZW50IHtcclxuICAgICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICBzZWFyY2hQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpXHJcbiAgICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgICAgIHRoaXMuYWRkTGlzdGVuZXJzKClcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICBhZGRMaXN0ZW5lcnMoKXtcclxuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJyNzb3J0LWJ5JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCk9PiB0aGlzLnNvcnRCeSgpKVxyXG4gICAgICAgIHRoaXMucXVlcnlTZWxlY3RvckFsbCgnLm1haW4tZmlsdGVyc19fZmlsdGVyc19faXRlbScpLmZvckVhY2goZWwgPT4gZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHRoaXMub3BlbkZpbHRlcihlbCkpKVxyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT4ge1xyXG4gICAgICAgICAgaWYoIWUudGFyZ2V0LmNsb3Nlc3QoJy5tYWluLWZpbHRlcnNfX2ZpbHRlcnNfX2l0ZW0nKSAmJiAhZS50YXJnZXQuY2xvc2VzdCgnLm1haW4tZmlsdGVyc19fZmlsdGVyc19faXRlbV9fZHJvcGRvd24nKSl7XHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvckFsbCgnLm1haW4tZmlsdGVyc19fZmlsdGVyc19faXRlbScpLmZvckVhY2goZWwgPT4gZWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tYWluLWZpbHRlcnNfX2ZpbHRlcnNfX2l0ZW1fX2xpc3RfX2FkZF9maWx0ZXInKS5mb3JFYWNoKGVsID0+IGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT4gdGhpcy51cGRhdGVQYWdlKGVsLCBlKSkpXHJcbiAgICAgIH1cclxuICBcclxuICAgICAgc29ydEJ5KCl7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hQYXJhbXMuc2V0KCdzb3J0X2J5JywgdGhpcy5xdWVyeVNlbGVjdG9yKCcjc29ydC1ieScpLnZhbHVlKVxyXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5zZWFyY2ggPSB0aGlzLnNlYXJjaFBhcmFtcy50b1N0cmluZygpXHJcbiAgICAgIH1cclxuICBcclxuICAgICAgb3BlbkZpbHRlcihlbCl7XHJcbiAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yQWxsKCcubWFpbi1maWx0ZXJzX19maWx0ZXJzX19pdGVtJykuZm9yRWFjaChlbCA9PiBlbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSlcclxuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIHVwZGF0ZVBhZ2UoZWwsZSl7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgY29uc3QgZmlsdGVyVmFsdWUgPSBlbC5kYXRhc2V0LmZpbHRlclZhbHVlXHJcbiAgICAgICAgZmV0Y2god2luZG93LnRoZW1lLnNob3BVcmwgKyBmaWx0ZXJWYWx1ZSlcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHJlcy50ZXh0KCkpXHJcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCBudWxsLCB3aW5kb3cudGhlbWUuc2hvcFVybCArIGZpbHRlclZhbHVlKVxyXG4gICAgICAgICAgICB0aGlzLnNlYXJjaFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaClcclxuICAgICAgICAgICAgY29uc3QgaHRtbCA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoZGF0YSwgXCJ0ZXh0L2h0bWxcIik7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYWluLWNvbGxlY3Rpb25fX3Byb2R1Y3RzJykuaW5uZXJIVE1MID0gaHRtbC5xdWVyeVNlbGVjdG9yKCcubWFpbi1jb2xsZWN0aW9uX19wcm9kdWN0cycpLmlubmVySFRNTFxyXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tYWluLWZpbHRlcnNfX2ZpbHRlcnNfX2l0ZW1fX2xpc3QnKS5mb3JFYWNoKChlbCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICBlbC5pbm5lckhUTUwgPSBodG1sLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tYWluLWZpbHRlcnNfX2ZpbHRlcnNfX2l0ZW1fX2xpc3QnKVtpbmRleF0uaW5uZXJIVE1MXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLm1haW4tZmlsdGVyc19fY2hlY2tlZCcpLmlubmVySFRNTCA9IGh0bWwucXVlcnlTZWxlY3RvcignLm1haW4tZmlsdGVyc19fY2hlY2tlZCcpLmlubmVySFRNTFxyXG4gICAgICAgICAgICB0aGlzLmFkZExpc3RlbmVycygpXHJcbiAgICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICB9KVxyXG4gIH1cbn0se31dfSx7fSxbMV0pXG5cbiJdfQ==
