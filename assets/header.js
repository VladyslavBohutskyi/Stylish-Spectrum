"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _wrapNativeSuper(e){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function _construct(e,t,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);t=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(t,r.prototype),t}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function n(o,i,u){function a(t,e){if(!i[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(s)return s(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=i[t]={exports:{}},o[t][0].call(r.exports,function(e){return a(o[t][1][e]||e)},r,r.exports,n,o,i,u)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<u.length;e++)a(u[e]);return a}({1:[function(e,t,r){e("./scripts/pubsub");customElements.get("s-header")||customElements.define("s-header",function(){_inherits(t,_wrapNativeSuper(HTMLElement));var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.call(this)}return _createClass(t,[{key:"connectedCallback",value:function(){var t=this;this.megaMenus=Array.from(this.querySelectorAll(".s-mega-menu")),this.menuItems=this.querySelectorAll(".s-header__menu_item"),this.querySelector(".s-header__account_cart").addEventListener("click",this.opeenCartDrawer),PubSub.subscribe("cart-updated",this.updateCount.bind(this)),this.menuItems.forEach(function(e){t.addClassParentMenu(e),t.openMegaMenuMobile(e),t.openMegaMenuDesktop(e),t.closeMegaMenuDesktop(e)}),this.toggleMenuMobile(),this.closeMegaMenuMobile(),this.querySelector(".s-header__open-search")&&this.querySelector(".s-header__open-search").addEventListener("click",function(){return t.openSearch()})}},{key:"opeenCartDrawer",value:function(){PubSub.publish("open-drawer")}},{key:"openSearch",value:function(){PubSub.publish("open-search")}},{key:"updateCount",value:function(){var t=this;fetch(window.theme.shopUrl+"/cart.js").then(function(e){return e.json()}).then(function(e){t.querySelector(".header_cart_count").innerHTML=e.item_count})}},{key:"addClassParentMenu",value:function(t){this.megaMenus.map(function(e){t.getElementsByTagName("a")[0].innerHTML==e.getAttribute("data-parent-menu")&&t.classList.add("s-header__menu_item--parent")})}},{key:"openMegaMenuDesktop",value:function(e){var r=this;e.addEventListener("mouseover",function(t){r.megaMenus.map(function(e){t.target.innerHTML==e.getAttribute("data-parent-menu")&&e.classList.add("active")})})}},{key:"closeMegaMenuDesktop",value:function(e){var r=this;e.addEventListener("mouseout",function(t){r.megaMenus.map(function(e){t.target.innerHTML==e.getAttribute("data-parent-menu")&&e.classList.remove("active")})})}},{key:"toggleMenuMobile",value:function(){var e=this;this.querySelector(".s-header__menu_btn").addEventListener("click",function(){return document.querySelector(".body_overlay").classList.toggle("active"),e.querySelector(".s-header").classList.toggle("s-header--menu-active"),document.querySelector("body").classList.toggle("hidden"),e.querySelector(".s-header__menu").classList.remove("hide"),e.megaMenus.map(function(e){e.classList.remove("active")})})}},{key:"openMegaMenuMobile",value:function(e){var r=this;e.querySelector(".s-header__menu_item_arrow").addEventListener("click",function(t){r.megaMenus.map(function(e){t.target.getAttribute("data-menu-name")==e.getAttribute("data-parent-menu")&&(e.classList.add("active"),r.querySelector(".s-header__menu").classList.add("hide"))})})}},{key:"closeMegaMenuMobile",value:function(){var t=this;this.querySelectorAll(".s-mega-menu__close").forEach(function(e){e.addEventListener("click",function(e){t.querySelector(".s-header__menu").classList.remove("hide"),t.megaMenus.map(function(e){e.classList.remove("active")})})})}}]),t}())},{"./scripts/pubsub":2}],2:[function(e,t,r){t.exports={EVENTS:{cartUpdated:"cart-updated",openCartDrawer:"open-drawer",openSearch:"open-search"},subscribers:{},subscribe:function(e,t){var r=this;return void 0===this.subscribers[e]&&(this.subscribers[e]=[]),this.subscribers[e]=[].concat(_toConsumableArray(this.subscribers[e]),[t]),function(){r.subscribers[e]=r.subscribers[e].filter(function(e){return e!==t})}},publish:function(e,t){this.subscribers[e]&&this.subscribers[e].forEach(function(e){e(t)})}}},{}]},{},[1]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvaGVhZGVyLmpzIiwiaGVhZGVyLmpzIiwic3JjL3NjcmlwdHMvcHVic3ViLmpzIl0sIm5hbWVzIjpbInIiLCJlIiwibiIsInQiLCJvIiwiaSIsImYiLCJjIiwicmVxdWlyZSIsInUiLCJhIiwiRXJyb3IiLCJjb2RlIiwicCIsImV4cG9ydHMiLCJjYWxsIiwibGVuZ3RoIiwiMSIsIm1vZHVsZSIsImN1c3RvbUVsZW1lbnRzIiwiZ2V0IiwiZGVmaW5lIiwiX2luaGVyaXRzIiwiU0hlYWRlciIsIl93cmFwTmF0aXZlU3VwZXIiLCJIVE1MRWxlbWVudCIsIl9zdXBlciIsIl9jcmVhdGVTdXBlciIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfY3JlYXRlQ2xhc3MiLCJrZXkiLCJ2YWx1ZSIsIl90aGlzIiwibWVnYU1lbnVzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIm1lbnVJdGVtcyIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwib3BlZW5DYXJ0RHJhd2VyIiwiUHViU3ViIiwic3Vic2NyaWJlIiwidXBkYXRlQ291bnQiLCJiaW5kIiwiZm9yRWFjaCIsIm1lbnVJdGVtIiwiYWRkQ2xhc3NQYXJlbnRNZW51Iiwib3Blbk1lZ2FNZW51TW9iaWxlIiwib3Blbk1lZ2FNZW51RGVza3RvcCIsImNsb3NlTWVnYU1lbnVEZXNrdG9wIiwidG9nZ2xlTWVudU1vYmlsZSIsImNsb3NlTWVnYU1lbnVNb2JpbGUiLCJvcGVuU2VhcmNoIiwicHVibGlzaCIsIl90aGlzMiIsImZldGNoIiwid2luZG93IiwidGhlbWUiLCJzaG9wVXJsIiwidGhlbiIsInJlcyIsImpzb24iLCJkYXRhIiwiaW5uZXJIVE1MIiwiaXRlbV9jb3VudCIsIm1hcCIsIm1lZ2FNZW51SXRlbSIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiZ2V0QXR0cmlidXRlIiwiY2xhc3NMaXN0IiwiYWRkIiwiX3RoaXMzIiwidGFyZ2V0IiwiX3RoaXM0IiwicmVtb3ZlIiwiX3RoaXM1IiwiZG9jdW1lbnQiLCJ0b2dnbGUiLCJfdGhpczYiLCJfdGhpczciLCJjbG9zZU1lZ2FNZW51IiwiLi9zY3JpcHRzL3B1YnN1YiIsIkVWRU5UUyIsImNhcnRVcGRhdGVkIiwib3BlbkNhcnREcmF3ZXIiLCJzdWJzY3JpYmVycyIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwiX3RoaXM4IiwidW5kZWZpbmVkIiwiY29uY2F0IiwiX3RvQ29uc3VtYWJsZUFycmF5IiwiZmlsdGVyIiwiY2IiXSwibWFwcGluZ3MiOiI2MElBQUEsQ0FBQSxTQUFBQSxFQUFBQyxFQUFBQyxFQUFBQyxHQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQUEsR0FBQSxDQUFBSixFQUFBRyxHQUFBLENBQUEsR0FBQSxDQUFBSixFQUFBSSxHQUFBLENBQUEsSUFBQUUsRUFBQSxZQUFBLE9BQUFDLFNBQUFBLFFBQUEsR0FBQSxDQUFBRixHQUFBQyxFQUFBLE9BQUFBLEVBQUFGLEVBQUEsQ0FBQSxDQUFBLEVBQUEsR0FBQUksRUFBQSxPQUFBQSxFQUFBSixFQUFBLENBQUEsQ0FBQSxFQUFBLE1BQUFLLEVBQUEsSUFBQUMsTUFBQSx1QkFBQU4sRUFBQSxHQUFBLEdBQUFPLEtBQUEsbUJBQUFGLENBQUEsQ0FBQUcsRUFBQVgsRUFBQUcsR0FBQSxDQUFBUyxRQUFBLEVBQUEsRUFBQWIsRUFBQUksR0FBQSxHQUFBVSxLQUFBRixFQUFBQyxRQUFBLFNBQUFkLEdBQUEsT0FBQUksRUFBQUgsRUFBQUksR0FBQSxHQUFBTCxJQUFBQSxDQUFBLENBQUEsRUFBQWEsRUFBQUEsRUFBQUMsUUFBQWQsRUFBQUMsRUFBQUMsRUFBQUMsQ0FBQSxDQUFBLENBQUEsT0FBQUQsRUFBQUcsR0FBQVMsT0FBQSxDQUFBLElBQUEsSUFBQUwsRUFBQSxZQUFBLE9BQUFELFNBQUFBLFFBQUFILEVBQUEsRUFBQUEsRUFBQUYsRUFBQWEsT0FBQVgsQ0FBQSxHQUFBRCxFQUFBRCxFQUFBRSxF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Q0F5R0EsQ0NJQSxFQUFFLENBQUM0RCxtQkQ3REgzQyxDQUFBQSxHQUFBQSxFQUFBQSxDQUFBQSxTQUFBaEMsRUFBQVUsRUFBQUosR0VwREFJLEVBQUFKLFFBQUEsQ0FDQXNFLE9BQUEsQ0FDQUMsWUFBQSxlQUNBQyxlQUFBLGNBQ0FoQyxXQUFBLGFBQ0EsRUFDQWlDLFlBQUEsR0FDQTVDLFVBQUEsU0FBQTZDLEVBQUFDLEdBQUEsSUFBQUMsRUFBQTdELEtBT0EsT0FOQThELEtBQUFBLElBQUE5RCxLQUFBMEQsWUFBQUMsS0FDQTNELEtBQUEwRCxZQUFBQyxHQUFBLElBR0EzRCxLQUFBMEQsWUFBQUMsR0FBQSxHQUFBSSxPQUFBQyxtQkFBQWhFLEtBQUEwRCxZQUFBQyxFQUFBLEVBQUEsQ0FBQUMsRUFBQSxFQUVBLFdBQ0FDLEVBQUFILFlBQUFDLEdBQUFFLEVBQUFILFlBQUFDLEdBQUFNLE9BQUEsU0FBQUMsR0FDQSxPQUFBQSxJQUFBTixDQUNBLENBQUEsQ0FDQSxDQUNBLEVBQ0FsQyxRQUFBLFNBQUFpQyxFQUFBeEIsR0FDQW5DLEtBQUEwRCxZQUFBQyxJQUNBM0QsS0FBQTBELFlBQUFDLEdBQUExQyxRQUFBLFNBQUEyQyxHQUNBQSxFQUFBekIsQ0FBQSxDQUNBLENBQUEsQ0FFQSxDQUNBLENEb0hBLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxFRHpEWGpCIiwiZmlsZSI6ImhlYWRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJjb25zdCBwdWJzdWIgPSByZXF1aXJlKFwiLi9zY3JpcHRzL3B1YnN1YlwiKTtcclxuXHJcbmlmICghY3VzdG9tRWxlbWVudHMuZ2V0KCdzLWhlYWRlcicpKSB7XHJcblxyXG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZSgncy1oZWFkZXInLCBjbGFzcyBTSGVhZGVyIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgIHN1cGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICAgIHRoaXMubWVnYU1lbnVzID0gQXJyYXkuZnJvbSh0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zLW1lZ2EtbWVudScpKVxyXG4gICAgICB0aGlzLm1lbnVJdGVtcyA9IHRoaXMucXVlcnlTZWxlY3RvckFsbCgnLnMtaGVhZGVyX19tZW51X2l0ZW0nKVxyXG4gICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5zLWhlYWRlcl9fYWNjb3VudF9jYXJ0JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9wZWVuQ2FydERyYXdlcilcclxuICAgICAgUHViU3ViLnN1YnNjcmliZSgnY2FydC11cGRhdGVkJywgdGhpcy51cGRhdGVDb3VudC5iaW5kKHRoaXMpKVxyXG4gICAgICB0aGlzLm1lbnVJdGVtcy5mb3JFYWNoKChtZW51SXRlbSkgPT4ge1xyXG4gICAgICAgIHRoaXMuYWRkQ2xhc3NQYXJlbnRNZW51KG1lbnVJdGVtKVxyXG4gICAgICAgIHRoaXMub3Blbk1lZ2FNZW51TW9iaWxlKG1lbnVJdGVtKVxyXG4gICAgICAgIHRoaXMub3Blbk1lZ2FNZW51RGVza3RvcChtZW51SXRlbSlcclxuICAgICAgICB0aGlzLmNsb3NlTWVnYU1lbnVEZXNrdG9wKG1lbnVJdGVtKVxyXG4gICAgICB9KVxyXG4gICAgICB0aGlzLnRvZ2dsZU1lbnVNb2JpbGUoKVxyXG4gICAgICB0aGlzLmNsb3NlTWVnYU1lbnVNb2JpbGUoKVxyXG4gICAgICBpZih0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5zLWhlYWRlcl9fb3Blbi1zZWFyY2gnKSl7XHJcbiAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCcucy1oZWFkZXJfX29wZW4tc2VhcmNoJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLm9wZW5TZWFyY2goKSlcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9wZWVuQ2FydERyYXdlcigpe1xyXG4gICAgICBQdWJTdWIucHVibGlzaCgnb3Blbi1kcmF3ZXInKVxyXG4gICAgfVxyXG5cclxuICAgIG9wZW5TZWFyY2goKXtcclxuICAgICAgUHViU3ViLnB1Ymxpc2goJ29wZW4tc2VhcmNoJylcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVDb3VudCgpe1xyXG4gICAgICBmZXRjaCh3aW5kb3cudGhlbWUuc2hvcFVybCArICcvY2FydC5qcycpXHJcbiAgICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLmpzb24oKSlcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX2NhcnRfY291bnQnKS5pbm5lckhUTUwgPSBkYXRhLml0ZW1fY291bnRcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGFkZENsYXNzUGFyZW50TWVudShtZW51SXRlbSkge1xyXG4gICAgICB0aGlzLm1lZ2FNZW51cy5tYXAoKG1lZ2FNZW51SXRlbSkgPT4ge1xyXG4gICAgICAgIG1lbnVJdGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhJylbMF0uaW5uZXJIVE1MID09IG1lZ2FNZW51SXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFyZW50LW1lbnUnKVxyXG4gICAgICAgICAgPyBtZW51SXRlbS5jbGFzc0xpc3QuYWRkKCdzLWhlYWRlcl9fbWVudV9pdGVtLS1wYXJlbnQnKVxyXG4gICAgICAgICAgOiBmYWxzZVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIG9wZW5NZWdhTWVudURlc2t0b3AobWVudUl0ZW0pIHtcclxuICAgICAgbWVudUl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKGUpID0+IHtcclxuICAgICAgICB0aGlzLm1lZ2FNZW51cy5tYXAoKG1lZ2FNZW51SXRlbSkgPT4ge1xyXG4gICAgICAgICAgZS50YXJnZXQuaW5uZXJIVE1MID09IG1lZ2FNZW51SXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFyZW50LW1lbnUnKVxyXG4gICAgICAgICAgICA/IG1lZ2FNZW51SXRlbS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxyXG4gICAgICAgICAgICA6IGZhbHNlXHJcbiAgICAgICAgfSlcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZU1lZ2FNZW51RGVza3RvcChtZW51SXRlbSkge1xyXG4gICAgICBtZW51SXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIChlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5tZWdhTWVudXMubWFwKChtZWdhTWVudUl0ZW0pID0+IHtcclxuICAgICAgICAgIGUudGFyZ2V0LmlubmVySFRNTCA9PSBtZWdhTWVudUl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXBhcmVudC1tZW51JylcclxuICAgICAgICAgICAgPyBtZWdhTWVudUl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcclxuICAgICAgICAgICAgOiBmYWxzZVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlTWVudU1vYmlsZSgpIHtcclxuICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCcucy1oZWFkZXJfX21lbnVfYnRuJykuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICBcImNsaWNrXCIsICgpID0+IChcclxuICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib2R5X292ZXJsYXknKS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKSxcclxuICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLnMtaGVhZGVyJykuY2xhc3NMaXN0LnRvZ2dsZSgncy1oZWFkZXItLW1lbnUtYWN0aXZlJyksXHJcbiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JykuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyksXHJcbiAgICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5zLWhlYWRlcl9fbWVudScpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKSxcclxuICAgICAgICAgIHRoaXMubWVnYU1lbnVzLm1hcCgoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIClcclxuICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIG9wZW5NZWdhTWVudU1vYmlsZShtZW51SXRlbSkge1xyXG4gICAgICBtZW51SXRlbS5xdWVyeVNlbGVjdG9yKCcucy1oZWFkZXJfX21lbnVfaXRlbV9hcnJvdycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICB0aGlzLm1lZ2FNZW51cy5tYXAoKG1lZ2FNZW51SXRlbSkgPT4ge1xyXG4gICAgICAgICAgaWYgKGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1tZW51LW5hbWUnKSA9PSBtZWdhTWVudUl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXBhcmVudC1tZW51JykpIHtcclxuICAgICAgICAgICAgbWVnYU1lbnVJdGVtLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLnMtaGVhZGVyX19tZW51JykuY2xhc3NMaXN0LmFkZCgnaGlkZScpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZU1lZ2FNZW51TW9iaWxlKCkge1xyXG4gICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zLW1lZ2EtbWVudV9fY2xvc2UnKS5mb3JFYWNoKChjbG9zZU1lZ2FNZW51KSA9PiB7XHJcbiAgICAgICAgY2xvc2VNZWdhTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5zLWhlYWRlcl9fbWVudScpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKVxyXG4gICAgICAgICAgdGhpcy5tZWdhTWVudXMubWFwKChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgfVxyXG4gIClcclxufVxyXG4iLCIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbmNvbnN0IHB1YnN1YiA9IHJlcXVpcmUoXCIuL3NjcmlwdHMvcHVic3ViXCIpO1xyXG5cclxuaWYgKCFjdXN0b21FbGVtZW50cy5nZXQoJ3MtaGVhZGVyJykpIHtcclxuXHJcbiAgY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdzLWhlYWRlcicsIGNsYXNzIFNIZWFkZXIgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgc3VwZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcclxuICAgICAgdGhpcy5tZWdhTWVudXMgPSBBcnJheS5mcm9tKHRoaXMucXVlcnlTZWxlY3RvckFsbCgnLnMtbWVnYS1tZW51JykpXHJcbiAgICAgIHRoaXMubWVudUl0ZW1zID0gdGhpcy5xdWVyeVNlbGVjdG9yQWxsKCcucy1oZWFkZXJfX21lbnVfaXRlbScpXHJcbiAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLnMtaGVhZGVyX19hY2NvdW50X2NhcnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub3BlZW5DYXJ0RHJhd2VyKVxyXG4gICAgICBQdWJTdWIuc3Vic2NyaWJlKCdjYXJ0LXVwZGF0ZWQnLCB0aGlzLnVwZGF0ZUNvdW50LmJpbmQodGhpcykpXHJcbiAgICAgIHRoaXMubWVudUl0ZW1zLmZvckVhY2goKG1lbnVJdGVtKSA9PiB7XHJcbiAgICAgICAgdGhpcy5hZGRDbGFzc1BhcmVudE1lbnUobWVudUl0ZW0pXHJcbiAgICAgICAgdGhpcy5vcGVuTWVnYU1lbnVNb2JpbGUobWVudUl0ZW0pXHJcbiAgICAgICAgdGhpcy5vcGVuTWVnYU1lbnVEZXNrdG9wKG1lbnVJdGVtKVxyXG4gICAgICAgIHRoaXMuY2xvc2VNZWdhTWVudURlc2t0b3AobWVudUl0ZW0pXHJcbiAgICAgIH0pXHJcbiAgICAgIHRoaXMudG9nZ2xlTWVudU1vYmlsZSgpXHJcbiAgICAgIHRoaXMuY2xvc2VNZWdhTWVudU1vYmlsZSgpXHJcbiAgICAgIGlmKHRoaXMucXVlcnlTZWxlY3RvcignLnMtaGVhZGVyX19vcGVuLXNlYXJjaCcpKXtcclxuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5zLWhlYWRlcl9fb3Blbi1zZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMub3BlblNlYXJjaCgpKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb3BlZW5DYXJ0RHJhd2VyKCl7XHJcbiAgICAgIFB1YlN1Yi5wdWJsaXNoKCdvcGVuLWRyYXdlcicpXHJcbiAgICB9XHJcblxyXG4gICAgb3BlblNlYXJjaCgpe1xyXG4gICAgICBQdWJTdWIucHVibGlzaCgnb3Blbi1zZWFyY2gnKVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUNvdW50KCl7XHJcbiAgICAgIGZldGNoKHdpbmRvdy50aGVtZS5zaG9wVXJsICsgJy9jYXJ0LmpzJylcclxuICAgICAgICAudGhlbigocmVzKSA9PiByZXMuanNvbigpKVxyXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfY2FydF9jb3VudCcpLmlubmVySFRNTCA9IGRhdGEuaXRlbV9jb3VudFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgYWRkQ2xhc3NQYXJlbnRNZW51KG1lbnVJdGVtKSB7XHJcbiAgICAgIHRoaXMubWVnYU1lbnVzLm1hcCgobWVnYU1lbnVJdGVtKSA9PiB7XHJcbiAgICAgICAgbWVudUl0ZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2EnKVswXS5pbm5lckhUTUwgPT0gbWVnYU1lbnVJdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1wYXJlbnQtbWVudScpXHJcbiAgICAgICAgICA/IG1lbnVJdGVtLmNsYXNzTGlzdC5hZGQoJ3MtaGVhZGVyX19tZW51X2l0ZW0tLXBhcmVudCcpXHJcbiAgICAgICAgICA6IGZhbHNlXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgb3Blbk1lZ2FNZW51RGVza3RvcChtZW51SXRlbSkge1xyXG4gICAgICBtZW51SXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMubWVnYU1lbnVzLm1hcCgobWVnYU1lbnVJdGVtKSA9PiB7XHJcbiAgICAgICAgICBlLnRhcmdldC5pbm5lckhUTUwgPT0gbWVnYU1lbnVJdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1wYXJlbnQtbWVudScpXHJcbiAgICAgICAgICAgID8gbWVnYU1lbnVJdGVtLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXHJcbiAgICAgICAgICAgIDogZmFsc2VcclxuICAgICAgICB9KVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlTWVnYU1lbnVEZXNrdG9wKG1lbnVJdGVtKSB7XHJcbiAgICAgIG1lbnVJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3V0JywgKGUpID0+IHtcclxuICAgICAgICB0aGlzLm1lZ2FNZW51cy5tYXAoKG1lZ2FNZW51SXRlbSkgPT4ge1xyXG4gICAgICAgICAgZS50YXJnZXQuaW5uZXJIVE1MID09IG1lZ2FNZW51SXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFyZW50LW1lbnUnKVxyXG4gICAgICAgICAgICA/IG1lZ2FNZW51SXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxyXG4gICAgICAgICAgICA6IGZhbHNlXHJcbiAgICAgICAgfSlcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVNZW51TW9iaWxlKCkge1xyXG4gICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5zLWhlYWRlcl9fbWVudV9idG4nKS5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICAgIFwiY2xpY2tcIiwgKCkgPT4gKFxyXG4gICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvZHlfb3ZlcmxheScpLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpLFxyXG4gICAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCcucy1oZWFkZXInKS5jbGFzc0xpc3QudG9nZ2xlKCdzLWhlYWRlci0tbWVudS1hY3RpdmUnKSxcclxuICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKSxcclxuICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLnMtaGVhZGVyX19tZW51JykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpLFxyXG4gICAgICAgICAgdGhpcy5tZWdhTWVudXMubWFwKChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgKVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgb3Blbk1lZ2FNZW51TW9iaWxlKG1lbnVJdGVtKSB7XHJcbiAgICAgIG1lbnVJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5zLWhlYWRlcl9fbWVudV9pdGVtX2Fycm93JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMubWVnYU1lbnVzLm1hcCgobWVnYU1lbnVJdGVtKSA9PiB7XHJcbiAgICAgICAgICBpZiAoZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW1lbnUtbmFtZScpID09IG1lZ2FNZW51SXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFyZW50LW1lbnUnKSkge1xyXG4gICAgICAgICAgICBtZWdhTWVudUl0ZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcclxuICAgICAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCcucy1oZWFkZXJfX21lbnUnKS5jbGFzc0xpc3QuYWRkKCdoaWRlJylcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlTWVnYU1lbnVNb2JpbGUoKSB7XHJcbiAgICAgIHRoaXMucXVlcnlTZWxlY3RvckFsbCgnLnMtbWVnYS1tZW51X19jbG9zZScpLmZvckVhY2goKGNsb3NlTWVnYU1lbnUpID0+IHtcclxuICAgICAgICBjbG9zZU1lZ2FNZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLnMtaGVhZGVyX19tZW51JykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpXHJcbiAgICAgICAgICB0aGlzLm1lZ2FNZW51cy5tYXAoKGUpID0+IHtcclxuICAgICAgICAgICAgZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgKVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICB9XHJcbiAgKVxyXG59XHJcblxufSx7XCIuL3NjcmlwdHMvcHVic3ViXCI6Mn1dLDI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xubW9kdWxlLmV4cG9ydHMgPSB7XHJcblx0RVZFTlRTOiB7XHJcblx0XHRjYXJ0VXBkYXRlZDogJ2NhcnQtdXBkYXRlZCcsXHJcblx0XHRvcGVuQ2FydERyYXdlcjogJ29wZW4tZHJhd2VyJyxcclxuXHRcdG9wZW5TZWFyY2g6ICdvcGVuLXNlYXJjaCcsXHJcblx0fSxcclxuXHRzdWJzY3JpYmVyczoge30sXHJcblx0c3Vic2NyaWJlOiBmdW5jdGlvbiAoZXZlbnROYW1lLCBjYWxsYmFjaykge1xyXG5cdFx0aWYgKHRoaXMuc3Vic2NyaWJlcnNbZXZlbnROYW1lXSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHRoaXMuc3Vic2NyaWJlcnNbZXZlbnROYW1lXSA9IFtdO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuc3Vic2NyaWJlcnNbZXZlbnROYW1lXSA9IFsuLi50aGlzLnN1YnNjcmliZXJzW2V2ZW50TmFtZV0sIGNhbGxiYWNrXTtcclxuXHJcblx0XHRyZXR1cm4gKCkgPT4ge1xyXG5cdFx0XHR0aGlzLnN1YnNjcmliZXJzW2V2ZW50TmFtZV0gPSB0aGlzLnN1YnNjcmliZXJzW2V2ZW50TmFtZV0uZmlsdGVyKChjYikgPT4ge1xyXG5cdFx0XHRcdHJldHVybiBjYiAhPT0gY2FsbGJhY2s7XHJcblx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHR9LFxyXG5cdHB1Ymxpc2g6IGZ1bmN0aW9uIChldmVudE5hbWUsIGRhdGEpIHtcclxuXHRcdGlmICh0aGlzLnN1YnNjcmliZXJzW2V2ZW50TmFtZV0pIHtcclxuXHRcdFx0dGhpcy5zdWJzY3JpYmVyc1tldmVudE5hbWVdLmZvckVhY2goKGNhbGxiYWNrKSA9PiB7XHJcblx0XHRcdFx0Y2FsbGJhY2soZGF0YSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cbn0se31dfSx7fSxbMV0pXG5cbiIsIm1vZHVsZS5leHBvcnRzID0ge1xyXG5cdEVWRU5UUzoge1xyXG5cdFx0Y2FydFVwZGF0ZWQ6ICdjYXJ0LXVwZGF0ZWQnLFxyXG5cdFx0b3BlbkNhcnREcmF3ZXI6ICdvcGVuLWRyYXdlcicsXHJcblx0XHRvcGVuU2VhcmNoOiAnb3Blbi1zZWFyY2gnLFxyXG5cdH0sXHJcblx0c3Vic2NyaWJlcnM6IHt9LFxyXG5cdHN1YnNjcmliZTogZnVuY3Rpb24gKGV2ZW50TmFtZSwgY2FsbGJhY2spIHtcclxuXHRcdGlmICh0aGlzLnN1YnNjcmliZXJzW2V2ZW50TmFtZV0gPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHR0aGlzLnN1YnNjcmliZXJzW2V2ZW50TmFtZV0gPSBbXTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnN1YnNjcmliZXJzW2V2ZW50TmFtZV0gPSBbLi4udGhpcy5zdWJzY3JpYmVyc1tldmVudE5hbWVdLCBjYWxsYmFja107XHJcblxyXG5cdFx0cmV0dXJuICgpID0+IHtcclxuXHRcdFx0dGhpcy5zdWJzY3JpYmVyc1tldmVudE5hbWVdID0gdGhpcy5zdWJzY3JpYmVyc1tldmVudE5hbWVdLmZpbHRlcigoY2IpID0+IHtcclxuXHRcdFx0XHRyZXR1cm4gY2IgIT09IGNhbGxiYWNrO1xyXG5cdFx0XHR9KTtcclxuXHRcdH07XHJcblx0fSxcclxuXHRwdWJsaXNoOiBmdW5jdGlvbiAoZXZlbnROYW1lLCBkYXRhKSB7XHJcblx0XHRpZiAodGhpcy5zdWJzY3JpYmVyc1tldmVudE5hbWVdKSB7XHJcblx0XHRcdHRoaXMuc3Vic2NyaWJlcnNbZXZlbnROYW1lXS5mb3JFYWNoKChjYWxsYmFjaykgPT4ge1xyXG5cdFx0XHRcdGNhbGxiYWNrKGRhdGEpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIl19
